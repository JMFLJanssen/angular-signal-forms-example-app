<div class="flex justify-center mb-6">
    <div class="w-1/2">
        @if (articleService.selectedID().length > 0) {
            <div class="flex flex-col gap-6 mt-6">
                <button matButton="filled" color="accent" (click)="back()" class="w-fit">
                    <mat-icon>arrow_back</mat-icon>All articles
                </button>
                <article-view [articleId]="articleService.selectedID()"></article-view>
            </div>
        } @else {
            <div class="w-full flex flex-col text-center text-white my-6">
                <span class="text-6xl">Articles</span>
                <small>all articles from the past year</small>
            </div>

            @let latestArticle = getLatest();
            @for (category of categoryService.categories(); track category.id; let first = $first) {
                @let articles = getArticlesByCategory(category.id);
                @if ((articles && articles.length > 0) || latestArticle.category === category.id) {
                    <div [class]="{ 'mt-6': !first }">
                        <mat-chip color="primary" class="w-fit">{{ category.name }}</mat-chip>
                    </div>
                    @if (latestArticle.category === category.id) {
                        <div
                            #imageContainer
                            class="relative w-full mt-3 cursor-pointer"
                            (click)="selectArticle(latestArticle.id)"
                        >
                            <img
                                [src]="latestArticle.image.imageUrl"
                                class="w-full h-100 object-cover rounded-md"
                            />
                            <div
                                class="absolute top-0 left-0 gradient w-full h-full rounded-sm"
                            ></div>
                            <div class="absolute bottom-3 left-6 text-white">
                                <h3>{{ latestArticle.title }}</h3>
                                <small>{{ latestArticle.excerpt }}</small>
                            </div>
                        </div>
                    }
                    @if (articles && articles.length > 0) {
                        <div class="mt-3">
                            <mat-action-list class="bg-grey-1 rounded-sm">
                                @for (item of articles; track item.id; let last = $last) {
                                    <mat-list-item lines="2" (click)="selectArticle(item.id)">
                                        <span matListItemTitle>{{ item.title }}</span>
                                        <small>{{ item.excerpt }}</small>
                                        <div matListItemMeta>
                                            <mat-icon color="accent">chevron_right</mat-icon>
                                        </div>
                                    </mat-list-item>
                                    @if (!last) {
                                        <div class="mx-3"><mat-divider /></div>
                                    }
                                }
                            </mat-action-list>
                        </div>
                    }
                }
            }
        }
    </div>
</div>
